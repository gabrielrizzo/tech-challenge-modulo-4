<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configura√ß√£o de Chaves de IA - Tech Challenge 4</title>
    <link rel="stylesheet" href="/frontend/config-styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üîê Configura√ß√£o de Chaves de IA</h1>
                <p class="subtitle">Tech Challenge M√≥dulo 4 - FIAP</p>
            </div>
            <nav>
                <a href="/frontend" class="nav-link">‚Üê Voltar ao App</a>
            </nav>
        </header>

        <main>
            <!-- Status do Arquivo .env -->
            <section class="card status-card" id="statusCard">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Verificando configura√ß√µes...</p>
                </div>
            </section>

            <!-- Formul√°rio de Configura√ß√£o -->
            <section class="card config-card">
                <h2>üîë Chaves de API</h2>
                <p class="info-text">Configure as chaves de API necess√°rias para o funcionamento do sistema</p>

                <form id="configForm">
                    <!-- OpenAI API Key -->
                    <div class="form-group">
                        <label for="openaiKey">
                            <span class="label-icon">ü§ñ</span>
                            OpenAI API Key
                            <span class="optional">(Opcional)</span>
                        </label>
                        <div class="input-wrapper">
                            <input 
                                type="password" 
                                id="openaiKey" 
                                name="openaiKey"
                                placeholder="sk-..." 
                                autocomplete="off"
                            />
                            <button type="button" class="toggle-visibility" onclick="toggleVisibility('openaiKey')">
                                üëÅÔ∏è
                            </button>
                        </div>
                        <small class="help-text">
                            Chave da OpenAI. Atualmente n√£o est√° sendo utilizada no projeto.
                            <a href="https://platform.openai.com/api-keys" target="_blank">Obter chave ‚Üí</a>
                        </small>
                    </div>

                    <!-- OpenRouter API Key -->
                    <div class="form-group">
                        <label for="openrouterKey">
                            <span class="label-icon">üåê</span>
                            OpenRouter API Key
                            <span class="required">* Obrigat√≥rio</span>
                        </label>
                        <div class="input-wrapper">
                            <input 
                                type="password" 
                                id="openrouterKey" 
                                name="openrouterKey"
                                placeholder="sk-or-v1-..." 
                                required
                                autocomplete="off"
                            />
                            <button type="button" class="toggle-visibility" onclick="toggleVisibility('openrouterKey')">
                                üëÅÔ∏è
                            </button>
                        </div>
                        <small class="help-text">
                            Chave do OpenRouter. <strong>Essencial</strong> para transcri√ß√£o e an√°lise de √°udio.
                            <a href="https://openrouter.ai/keys" target="_blank">Obter chave ‚Üí</a>
                        </small>
                    </div>

                    <!-- Bot√µes de A√ß√£o -->
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary" id="saveBtn">
                            üíæ Salvar Configura√ß√µes
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="loadCurrentConfig()">
                            üîÑ Recarregar
                        </button>
                        <button type="button" class="btn btn-danger" onclick="clearForm()">
                            üóëÔ∏è Limpar
                        </button>
                    </div>
                </form>
            </section>

            <!-- Informa√ß√µes sobre as Chaves -->
            <section class="card info-card">
                <h2>‚ÑπÔ∏è Informa√ß√µes Importantes</h2>
                
                <div class="info-grid">
                    <div class="info-item">
                        <h3>üîê Seguran√ßa</h3>
                        <ul>
                            <li>As chaves s√£o armazenadas no arquivo <code>.env</code> na raiz do projeto</li>
                            <li>O arquivo <code>.env</code> deve estar no <code>.gitignore</code></li>
                            <li><strong>Nunca compartilhe suas chaves</strong> publicamente</li>
                        </ul>
                    </div>

                    <div class="info-item">
                        <h3>üåê OpenRouter (Obrigat√≥rio)</h3>
                        <ul>
                            <li>Usado para <strong>transcri√ß√£o de √°udio</strong></li>
                            <li>Usado para <strong>an√°lise psicol√≥gica</strong></li>
                            <li>Modelo: GPT-4o Audio Preview</li>
                            <li>Formato: <code>sk-or-v1-...</code></li>
                        </ul>
                    </div>

                    <div class="info-item">
                        <h3>ü§ñ OpenAI (Opcional)</h3>
                        <ul>
                            <li>Atualmente <strong>n√£o est√° sendo usada</strong></li>
                            <li>Configurada para uso futuro</li>
                            <li>Formato: <code>sk-...</code></li>
                        </ul>
                    </div>

                    <div class="info-item">
                        <h3>‚úÖ Funcionalidades</h3>
                        <ul>
                            <li><strong>Com OpenRouter:</strong> Todos os recursos funcionam</li>
                            <li><strong>Sem OpenRouter:</strong> Apenas detec√ß√£o de emo√ß√£o funciona</li>
                            <li>Detec√ß√£o de emo√ß√£o usa modelo local</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Teste de Conectividade -->
            <section class="card test-card">
                <h2>üß™ Testar Configura√ß√£o</h2>
                <p class="info-text">Teste se as chaves est√£o funcionando corretamente</p>
                
                <div class="test-buttons">
                    <button class="btn btn-test" onclick="testOpenRouterKey()">
                        üåê Testar OpenRouter
                    </button>
                    <button class="btn btn-test" onclick="testHealthCheck()">
                        ‚ù§Ô∏è Health Check da API
                    </button>
                </div>

                <div id="testResults" class="test-results"></div>
            </section>
        </main>

        <footer>
            <p>FIAP - P√≥s-Gradua√ß√£o em Intelig√™ncia Artificial | 2026</p>
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 10px;">
                <strong>‚ö†Ô∏è Importante:</strong> Ap√≥s salvar, reinicie o servidor Flask para aplicar as mudan√ßas
            </p>
        </footer>
    </div>

    <script src="/frontend/config-script.js"></script>
</body>
</html>
